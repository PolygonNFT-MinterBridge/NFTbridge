{"ast":null,"code":"var _jsxFileName = \"/Users/pulkitmittal/nft-bridge/NFTbridge/src/components/Form/ExitModal.jsx\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\"; // material ui\n\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button, CircularProgress, Modal } from \"@material-ui/core\";\nimport { BlurOnOutlined, Close } from \"@material-ui/icons\"; // components\n\nimport ErrorBox from \"../UI/ErrorBox\"; // images\n\nimport thumbsUp from \"../../images/thumbs-up.png\";\nimport HexagonGraphic from \"../UI/HexagonGraphic\"; // web3\n\nimport { useWeb3Context } from \"../../contexts/Web3Context\";\nimport { rootChainPrimaryProvider } from \"../../utils/providers\";\nimport { exitERC721 } from \"../../utils/erc721\";\nimport { exitERC1155 } from \"../../utils/erc1155\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst ExitModal = ({\n  triggerModal,\n  setTriggerModal,\n  data,\n  db\n}) => {\n  _s();\n\n  const classes = useStyles();\n  const {\n    inj_provider,\n    providerChainId,\n    account\n  } = useWeb3Context();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [result, setResult] = useState(data.burnedTxn);\n\n  const hideModal = () => {\n    setTriggerModal(false);\n  };\n\n  const exit = async e => {\n    console.log(\"Exit function called...\");\n    e.preventDefault();\n    let maticPOSClient;\n\n    try {\n      setLoading(true); // create pos client insatnce\n\n      maticPOSClient = await rootChainPrimaryProvider(inj_provider);\n      console.log(\"got pos\", maticPOSClient); // check if checkpointed\n\n      let isProcessed;\n      console.log(isProcessed);\n\n      try {\n        if (data.nft721) {\n          isProcessed = await maticPOSClient.isBatchERC721ExitProcessed(data.txn);\n        } else {\n          console.log(\"test3\");\n          isProcessed = await maticPOSClient.isBatchERC1155ExitProcessed(data.txn);\n          let tx;\n          tx = await exitERC1155(maticPOSClient, data.txn);\n          console.log(tx, \"test1\"); // Update on Firebase \n\n          const snapshot = await db.collection('storeHash').doc(account);\n          const d = await snapshot.get();\n          const oldData = d.data();\n          const newArr = oldData.burnedTxn;\n          newArr[data.burnId] = tx;\n          const docRef = db.collection(\"storeHash\").doc(account);\n          await docRef.update({\n            burnedTxn: newArr\n          });\n          setResult(tx);\n        }\n      } catch (e) {\n        console.log(e); // checked do transaction\n\n        if (e.message === \"Log not found in receipt\") {\n          let tx;\n\n          if (data.nft721) {\n            tx = await exitERC721(maticPOSClient, data.txn);\n          } else {\n            tx = await exitERC1155(maticPOSClient, data.txn);\n          }\n\n          console.log(tx, \"test2\"); // Update on Firebase \n\n          const snapshot = await db.collection('storeHash').doc(account);\n          const d = await snapshot.get();\n          const oldData = d.data();\n          const newArr = oldData.burnedTxn;\n          newArr[data.burnId] = tx;\n          const docRef = db.collection(\"storeHash\").doc(account);\n          await docRef.update({\n            burnedTxn: newArr\n          });\n          setResult(tx);\n        } // Not checkpointed\n        else if (e.message === \"Burn transaction has not been checkpointed as yet\") {\n          console.log(\"not yet checkpointed\");\n          setError(`${e.message}yo`);\n        } else {\n          setError(`${e.message}hello`);\n        }\n      }\n\n      setLoading(false);\n    } catch (e) {\n      setError(e.toString());\n      if (e.message === \"Cannot read property 'eth' of undefined\") setError(\"Wallet not Connected\");else if (e.message.substr(0, 60) === \"execution reverted: RootChainManager: EXIT_ALREADY_PROCESSED\") setError(\"EXIT ALREADY PROCESSED\");else setError(e.message.substr(0, 70)); // console.log(e.message.substr(0, 63));\n\n      setLoading(false);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Modal, {\n      open: triggerModal,\n      \"aria-labelledby\": \"simple-modal-title\",\n      \"aria-describedby\": \"simple-modal-description\",\n      className: classes.modalContainer,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: classes.modal,\n        style: {\n          paddingTop: \"20px\",\n          paddingBottom: \"30px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.closeModal,\n          onClick: hideModal,\n          children: /*#__PURE__*/_jsxDEV(Close, {\n            style: {\n              fontSize: \"16px\"\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), !result && /*#__PURE__*/_jsxDEV(\"form\", {\n          className: classes.notificationForm,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: classes.title,\n            children: \"Exit Transaction\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 135,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.inputContainer,\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              htmlFor: \"txn\",\n              children: \"Transaction Hash\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 137,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"string\",\n              placeholder: \"0xE550A9B2A6B8e0F79C6E0397Ff7Bc2F6c0F...\",\n              value: data.txn,\n              required: true,\n              id: \"txn\",\n              readOnly: true,\n              style: {\n                pointerEvents: \"none\"\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 138,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.inputContainer,\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: [\"NFT Type - \", /*#__PURE__*/_jsxDEV(\"span\", {\n                children: data.nft721 ? \"ERC721\" : \"ERC1155\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 151,\n                columnNumber: 30\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 150,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              hidden: true,\n              disabled: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 153,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.btnContainer,\n            children: /*#__PURE__*/_jsxDEV(Button, {\n              className: `${classes.btn} ${classes.filled}`,\n              disabled: loading,\n              onClick: exit,\n              children: [loading && /*#__PURE__*/_jsxDEV(CircularProgress, {\n                className: `${classes.loading}`,\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 162,\n                columnNumber: 21\n              }, this), \"Exit\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 156,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 155,\n            columnNumber: 15\n          }, this), error && /*#__PURE__*/_jsxDEV(ErrorBox, {\n            message: error\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 13\n        }, this), result && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.successMsg,\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: classes.title,\n            style: {\n              marginBottom: \"60px\"\n            },\n            children: \"Exit Successfully\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.graphicSection,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"iconContainer\",\n              children: [/*#__PURE__*/_jsxDEV(\"img\", {\n                src: thumbsUp,\n                alt: \"thumb icon\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 183,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(HexagonGraphic, {\n                color: \"#1DBA2D\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 184,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 182,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: classes.textSection,\n            style: {\n              marginTop: \"30px\"\n            },\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Transaction hash:\", \" \", /*#__PURE__*/_jsxDEV(\"span\", {\n                children: /*#__PURE__*/_jsxDEV(\"a\", {\n                  href: providerChainId === 1 ? `https://etherscan.io/tx/${result}` : `https://goerli.etherscan.io/tx/${result}`,\n                  target: \"_blank\",\n                  rel: \"noopener noreferrer\",\n                  children: result\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 194,\n                  columnNumber: 21\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 193,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 191,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n};\n\n_s(ExitModal, \"rl2t1be7dTVA12KYAYzVO41/7C4=\", false, function () {\n  return [useStyles, useWeb3Context];\n});\n\n_c = ExitModal;\nconst useStyles = makeStyles(theme => ({ // input and label styling is written in theme.js. Check the overrides object\n  ...theme.overrides.formStyle,\n  ...theme.overrides.modalStyle,\n  purple: {\n    color: \"#7533E2\"\n  },\n  title: {\n    fontSize: \"20px\",\n    margin: \"0 0 30px 0\",\n    textAlign: \"center\"\n  },\n  successMsg: {\n    \"& img\": {\n      margin: \"44px auto\",\n      width: \"62px\"\n    }\n  }\n}));\nexport default ExitModal;\n\nvar _c;\n\n$RefreshReg$(_c, \"ExitModal\");","map":{"version":3,"sources":["/Users/pulkitmittal/nft-bridge/NFTbridge/src/components/Form/ExitModal.jsx"],"names":["React","useState","makeStyles","Button","CircularProgress","Modal","BlurOnOutlined","Close","ErrorBox","thumbsUp","HexagonGraphic","useWeb3Context","rootChainPrimaryProvider","exitERC721","exitERC1155","ExitModal","triggerModal","setTriggerModal","data","db","classes","useStyles","inj_provider","providerChainId","account","loading","setLoading","error","setError","result","setResult","burnedTxn","hideModal","exit","e","console","log","preventDefault","maticPOSClient","isProcessed","nft721","isBatchERC721ExitProcessed","txn","isBatchERC1155ExitProcessed","tx","snapshot","collection","doc","d","get","oldData","newArr","burnId","docRef","update","message","toString","substr","modalContainer","modal","paddingTop","paddingBottom","closeModal","fontSize","notificationForm","title","inputContainer","pointerEvents","btnContainer","btn","filled","successMsg","marginBottom","graphicSection","textSection","marginTop","theme","overrides","formStyle","modalStyle","purple","color","margin","textAlign","width"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\n\n// material ui\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { Button, CircularProgress, Modal } from \"@material-ui/core\";\nimport { BlurOnOutlined, Close } from \"@material-ui/icons\";\n\n// components\nimport ErrorBox from \"../UI/ErrorBox\";\n\n// images\nimport thumbsUp from \"../../images/thumbs-up.png\";\nimport HexagonGraphic from \"../UI/HexagonGraphic\";\n\n// web3\nimport { useWeb3Context } from \"../../contexts/Web3Context\";\nimport { rootChainPrimaryProvider } from \"../../utils/providers\";\nimport { exitERC721 } from \"../../utils/erc721\";\nimport { exitERC1155 } from \"../../utils/erc1155\";\n\nconst ExitModal = ({ triggerModal, setTriggerModal, data, db }) => {\n  const classes = useStyles();\n  const { inj_provider, providerChainId, account } = useWeb3Context();\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(\"\");\n  const [result, setResult] = useState(data.burnedTxn);\n\n  const hideModal = () => {\n    setTriggerModal(false);\n  };\n\n  const exit = async (e) => {\n    console.log(\"Exit function called...\");\n    e.preventDefault();\n    let maticPOSClient;\n    try {\n      setLoading(true);\n      // create pos client insatnce\n      maticPOSClient = await rootChainPrimaryProvider(inj_provider);\n      console.log(\"got pos\", maticPOSClient);\n\n      // check if checkpointed\n      let isProcessed;\n      console.log(isProcessed);\n      try {\n        if (data.nft721) {\n          isProcessed = await maticPOSClient.isBatchERC721ExitProcessed(data.txn);\n        } else {\n          console.log(\"test3\")\n          isProcessed = await maticPOSClient.isBatchERC1155ExitProcessed(data.txn);\n          let tx;\n          tx = await exitERC1155(maticPOSClient, data.txn);\n          console.log(tx,\"test1\");\n          // Update on Firebase \n          const snapshot = await db.collection('storeHash').doc(account);\n          const d = await snapshot.get();\n          const oldData = d.data();\n          const newArr = oldData.burnedTxn;\n          newArr[data.burnId] = tx\n          const docRef = db.collection(\"storeHash\").doc(account);\n          await docRef.update({\n            burnedTxn: newArr\n          });\n          setResult(tx);\n        }\n      } catch (e) {\n        console.log(e);\n        // checked do transaction\n        if (e.message === \"Log not found in receipt\") {\n          let tx;\n          if (data.nft721) {\n            tx = await exitERC721(maticPOSClient, data.txn);\n          } else {\n            tx = await exitERC1155(maticPOSClient, data.txn);\n          }\n          console.log(tx,\"test2\");\n\n          // Update on Firebase \n          const snapshot = await db.collection('storeHash').doc(account);\n          const d = await snapshot.get();\n          const oldData = d.data();\n          const newArr = oldData.burnedTxn;\n          newArr[data.burnId] = tx\n          const docRef = db.collection(\"storeHash\").doc(account);\n          await docRef.update({\n            burnedTxn: newArr\n          });\n\n          setResult(tx);\n        }\n        // Not checkpointed\n        else if (\n          e.message === \"Burn transaction has not been checkpointed as yet\"\n        ) {\n          console.log(\"not yet checkpointed\");\n          setError(`${e.message}yo`);\n        } else {\n          setError(`${e.message}hello`);\n        }\n      }\n      setLoading(false);\n    } catch (e) {\n      setError(e.toString());\n      if (e.message === \"Cannot read property 'eth' of undefined\")\n        setError(\"Wallet not Connected\");\n      else if (\n        e.message.substr(0, 60) ===\n        \"execution reverted: RootChainManager: EXIT_ALREADY_PROCESSED\"\n      )\n        setError(\"EXIT ALREADY PROCESSED\");\n      else setError(e.message.substr(0, 70));\n      // console.log(e.message.substr(0, 63));\n      setLoading(false);\n    }\n  };\n\n\n  return (\n    <>\n      <Modal\n        open={triggerModal}\n        aria-labelledby=\"simple-modal-title\"\n        aria-describedby=\"simple-modal-description\"\n        className={classes.modalContainer}\n      >\n        <div\n          className={classes.modal}\n          style={{ paddingTop: \"20px\", paddingBottom: \"30px\" }}\n        >\n          <div className={classes.closeModal} onClick={hideModal}>\n            <Close style={{ fontSize: \"16px\" }} />\n          </div>\n          {!result && (\n            <form className={classes.notificationForm}>\n              <h3 className={classes.title}>Exit Transaction</h3>\n              <div className={classes.inputContainer}>\n                <label htmlFor=\"txn\">Transaction Hash</label>\n                <input\n                  type=\"string\"\n                  placeholder=\"0xE550A9B2A6B8e0F79C6E0397Ff7Bc2F6c0F...\"\n                  value={data.txn}\n                  required\n                  id=\"txn\"\n                  readOnly\n                  style={{ pointerEvents: \"none\" }}\n                />\n              </div>\n              {/* This input is hidden. */}\n              <div className={classes.inputContainer}>\n                <label>\n                  NFT Type - <span>{data.nft721 ? \"ERC721\" : \"ERC1155\"}</span>\n                </label>\n                <input type=\"checkbox\" hidden disabled />\n              </div>\n              <div className={classes.btnContainer}>\n                <Button\n                  className={`${classes.btn} ${classes.filled}`}\n                  disabled={loading}\n                  onClick={exit}\n                >\n                  {loading && (\n                    <CircularProgress\n                      className={`${classes.loading}`}\n                      size={24}\n                    />\n                  )}\n                  Exit\n                </Button>\n              </div>\n              {/* error display */}\n              {error && <ErrorBox message={error} />}\n            </form>\n          )}\n\n          {/* result */}\n          {result && (\n            <div className={classes.successMsg}>\n              <h3 className={classes.title} style={{ marginBottom: \"60px\" }}>\n                Exit Successfully\n              </h3>\n              <div className={classes.graphicSection}>\n                <div className=\"iconContainer\">\n                  <img src={thumbsUp} alt=\"thumb icon\" />\n                  <HexagonGraphic color=\"#1DBA2D\" />\n                </div>\n              </div>\n              <div\n                className={classes.textSection}\n                style={{ marginTop: \"30px\" }}\n              >\n                <p>\n                  Transaction hash:{\" \"}\n                  <span>\n                    <a\n                      href={providerChainId === 1 ? `https://etherscan.io/tx/${result}` : `https://goerli.etherscan.io/tx/${result}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      {result}\n                    </a>\n                  </span>\n                </p>\n              </div>\n            </div>\n          )}\n        </div>\n      </Modal>\n    </>\n  );\n};\n\nconst useStyles = makeStyles((theme) => ({\n  // input and label styling is written in theme.js. Check the overrides object\n  ...theme.overrides.formStyle,\n  ...theme.overrides.modalStyle,\n  purple: {\n    color: \"#7533E2\",\n  },\n  title: {\n    fontSize: \"20px\",\n    margin: \"0 0 30px 0\",\n    textAlign: \"center\",\n  },\n  successMsg: {\n    \"& img\": {\n      margin: \"44px auto\",\n      width: \"62px\",\n    },\n  },\n}));\n\nexport default ExitModal;\n"]},"metadata":{},"sourceType":"module"}