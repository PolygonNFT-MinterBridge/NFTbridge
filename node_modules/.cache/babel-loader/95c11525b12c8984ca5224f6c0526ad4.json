{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\n\nvar _1 = require(\".\");\n\nvar TransactionFactory =\n/** @class */\nfunction () {\n  // It is not possible to instantiate a TransactionFactory object.\n  function TransactionFactory() {}\n  /**\n   * Create a transaction from a `txData` object\n   *\n   * @param txData - The transaction data. The `type` field will determine which transaction type is returned (if undefined, creates a legacy transaction)\n   * @param txOptions - Options to pass on to the constructor of the transaction\n   */\n\n\n  TransactionFactory.fromTxData = function (txData, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n\n    if (!('type' in txData) || txData.type === undefined) {\n      // Assume legacy transaction\n      return _1.Transaction.fromTxData(txData, txOptions);\n    } else {\n      var txType = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(txData.type)).toNumber();\n\n      if (txType === 0) {\n        return _1.Transaction.fromTxData(txData, txOptions);\n      } else if (txType === 1) {\n        return _1.AccessListEIP2930Transaction.fromTxData(txData, txOptions);\n      } else if (txType === 2) {\n        return _1.FeeMarketEIP1559Transaction.fromTxData(txData, txOptions);\n      } else {\n        throw new Error(\"Tx instantiation with type \".concat(txType, \" not supported\"));\n      }\n    }\n  };\n  /**\n   * This method tries to decode serialized data.\n   *\n   * @param data - The data Buffer\n   * @param txOptions - The transaction options\n   */\n\n\n  TransactionFactory.fromSerializedData = function (data, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n\n    if (data[0] <= 0x7f) {\n      // Determine the type.\n      var EIP = void 0;\n\n      switch (data[0]) {\n        case 1:\n          EIP = 2930;\n          break;\n\n        case 2:\n          EIP = 1559;\n          break;\n\n        default:\n          throw new Error(\"TypedTransaction with ID \".concat(data[0], \" unknown\"));\n      }\n\n      if (EIP === 1559) {\n        return _1.FeeMarketEIP1559Transaction.fromSerializedTx(data, txOptions);\n      } else {\n        // EIP === 2930\n        return _1.AccessListEIP2930Transaction.fromSerializedTx(data, txOptions);\n      }\n    } else {\n      return _1.Transaction.fromSerializedTx(data, txOptions);\n    }\n  };\n  /**\n   * When decoding a BlockBody, in the transactions field, a field is either:\n   * A Buffer (a TypedTransaction - encoded as TransactionType || rlp(TransactionPayload))\n   * A Buffer[] (Legacy Transaction)\n   * This method returns the right transaction.\n   *\n   * @param data - A Buffer or Buffer[]\n   * @param txOptions - The transaction options\n   */\n\n\n  TransactionFactory.fromBlockBodyData = function (data, txOptions) {\n    if (txOptions === void 0) {\n      txOptions = {};\n    }\n\n    if (Buffer.isBuffer(data)) {\n      return this.fromSerializedData(data, txOptions);\n    } else if (Array.isArray(data)) {\n      // It is a legacy transaction\n      return _1.Transaction.fromValuesArray(data, txOptions);\n    } else {\n      throw new Error('Cannot decode transaction: unknown type input');\n    }\n  };\n  /**\n   * This helper method allows one to retrieve the class which matches the transactionID\n   * If transactionID is undefined, returns the legacy transaction class.\n   * @deprecated - This method is deprecated and will be removed on the next major release\n   * @param transactionID\n   * @param _common - This option is not used\n   */\n\n\n  TransactionFactory.getTransactionClass = function (transactionID, _common) {\n    if (transactionID === void 0) {\n      transactionID = 0;\n    }\n\n    var legacyTxn = transactionID == 0 || transactionID >= 0x80 && transactionID <= 0xff;\n\n    if (legacyTxn) {\n      return _1.Transaction;\n    }\n\n    switch (transactionID) {\n      case 1:\n        return _1.AccessListEIP2930Transaction;\n\n      case 2:\n        return _1.FeeMarketEIP1559Transaction;\n\n      default:\n        throw new Error(\"TypedTransaction with ID \".concat(transactionID, \" unknown\"));\n    }\n  };\n\n  return TransactionFactory;\n}();\n\nexports.default = TransactionFactory;","map":{"version":3,"sources":["../src/transactionFactory.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar ethereumjs_util_1 = require(\"ethereumjs-util\");\nvar _1 = require(\".\");\nvar TransactionFactory = /** @class */ (function () {\n    // It is not possible to instantiate a TransactionFactory object.\n    function TransactionFactory() {\n    }\n    /**\n     * Create a transaction from a `txData` object\n     *\n     * @param txData - The transaction data. The `type` field will determine which transaction type is returned (if undefined, creates a legacy transaction)\n     * @param txOptions - Options to pass on to the constructor of the transaction\n     */\n    TransactionFactory.fromTxData = function (txData, txOptions) {\n        if (txOptions === void 0) { txOptions = {}; }\n        if (!('type' in txData) || txData.type === undefined) {\n            // Assume legacy transaction\n            return _1.Transaction.fromTxData(txData, txOptions);\n        }\n        else {\n            var txType = new ethereumjs_util_1.BN((0, ethereumjs_util_1.toBuffer)(txData.type)).toNumber();\n            if (txType === 0) {\n                return _1.Transaction.fromTxData(txData, txOptions);\n            }\n            else if (txType === 1) {\n                return _1.AccessListEIP2930Transaction.fromTxData(txData, txOptions);\n            }\n            else if (txType === 2) {\n                return _1.FeeMarketEIP1559Transaction.fromTxData(txData, txOptions);\n            }\n            else {\n                throw new Error(\"Tx instantiation with type \".concat(txType, \" not supported\"));\n            }\n        }\n    };\n    /**\n     * This method tries to decode serialized data.\n     *\n     * @param data - The data Buffer\n     * @param txOptions - The transaction options\n     */\n    TransactionFactory.fromSerializedData = function (data, txOptions) {\n        if (txOptions === void 0) { txOptions = {}; }\n        if (data[0] <= 0x7f) {\n            // Determine the type.\n            var EIP = void 0;\n            switch (data[0]) {\n                case 1:\n                    EIP = 2930;\n                    break;\n                case 2:\n                    EIP = 1559;\n                    break;\n                default:\n                    throw new Error(\"TypedTransaction with ID \".concat(data[0], \" unknown\"));\n            }\n            if (EIP === 1559) {\n                return _1.FeeMarketEIP1559Transaction.fromSerializedTx(data, txOptions);\n            }\n            else {\n                // EIP === 2930\n                return _1.AccessListEIP2930Transaction.fromSerializedTx(data, txOptions);\n            }\n        }\n        else {\n            return _1.Transaction.fromSerializedTx(data, txOptions);\n        }\n    };\n    /**\n     * When decoding a BlockBody, in the transactions field, a field is either:\n     * A Buffer (a TypedTransaction - encoded as TransactionType || rlp(TransactionPayload))\n     * A Buffer[] (Legacy Transaction)\n     * This method returns the right transaction.\n     *\n     * @param data - A Buffer or Buffer[]\n     * @param txOptions - The transaction options\n     */\n    TransactionFactory.fromBlockBodyData = function (data, txOptions) {\n        if (txOptions === void 0) { txOptions = {}; }\n        if (Buffer.isBuffer(data)) {\n            return this.fromSerializedData(data, txOptions);\n        }\n        else if (Array.isArray(data)) {\n            // It is a legacy transaction\n            return _1.Transaction.fromValuesArray(data, txOptions);\n        }\n        else {\n            throw new Error('Cannot decode transaction: unknown type input');\n        }\n    };\n    /**\n     * This helper method allows one to retrieve the class which matches the transactionID\n     * If transactionID is undefined, returns the legacy transaction class.\n     * @deprecated - This method is deprecated and will be removed on the next major release\n     * @param transactionID\n     * @param _common - This option is not used\n     */\n    TransactionFactory.getTransactionClass = function (transactionID, _common) {\n        if (transactionID === void 0) { transactionID = 0; }\n        var legacyTxn = transactionID == 0 || (transactionID >= 0x80 && transactionID <= 0xff);\n        if (legacyTxn) {\n            return _1.Transaction;\n        }\n        switch (transactionID) {\n            case 1:\n                return _1.AccessListEIP2930Transaction;\n            case 2:\n                return _1.FeeMarketEIP1559Transaction;\n            default:\n                throw new Error(\"TypedTransaction with ID \".concat(transactionID, \" unknown\"));\n        }\n    };\n    return TransactionFactory;\n}());\nexports.default = TransactionFactory;\n//# sourceMappingURL=transactionFactory.js.map"]},"metadata":{},"sourceType":"script"}