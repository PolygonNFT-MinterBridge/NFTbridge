{"ast":null,"code":"/*! firebase-admin v9.6.0 */\n\"use strict\";\n/*!\n * Copyright 2020 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RemoteConfig = void 0;\n\nvar validator = require(\"../utils/validator\");\n\nvar remote_config_api_client_internal_1 = require(\"./remote-config-api-client-internal\");\n/**\n * Remote Config service bound to the provided app.\n */\n\n\nvar RemoteConfig =\n/** @class */\nfunction () {\n  /**\n   * @param app The app for this RemoteConfig service.\n   * @constructor\n   */\n  function RemoteConfig(app) {\n    this.app = app;\n    this.client = new remote_config_api_client_internal_1.RemoteConfigApiClient(app);\n  }\n  /**\n   * Gets the current active version of the {@link remoteConfig.RemoteConfigTemplate\n   * `RemoteConfigTemplate`} of the project.\n   *\n   * @return A promise that fulfills with a `RemoteConfigTemplate`.\n   */\n\n\n  RemoteConfig.prototype.getTemplate = function () {\n    return this.client.getTemplate().then(function (templateResponse) {\n      return new RemoteConfigTemplateImpl(templateResponse);\n    });\n  };\n  /**\n   * Gets the requested version of the {@link remoteConfig.RemoteConfigTemplate\n    * `RemoteConfigTemplate`} of the project.\n   *\n   * @param versionNumber Version number of the Remote Config template to look up.\n   *\n   * @return A promise that fulfills with a `RemoteConfigTemplate`.\n   */\n\n\n  RemoteConfig.prototype.getTemplateAtVersion = function (versionNumber) {\n    return this.client.getTemplateAtVersion(versionNumber).then(function (templateResponse) {\n      return new RemoteConfigTemplateImpl(templateResponse);\n    });\n  };\n  /**\n   * Validates a {@link remoteConfig.RemoteConfigTemplate `RemoteConfigTemplate`}.\n   *\n   * @param template The Remote Config template to be validated.\n   * @returns A promise that fulfills with the validated `RemoteConfigTemplate`.\n   */\n\n\n  RemoteConfig.prototype.validateTemplate = function (template) {\n    return this.client.validateTemplate(template).then(function (templateResponse) {\n      return new RemoteConfigTemplateImpl(templateResponse);\n    });\n  };\n  /**\n   * Publishes a Remote Config template.\n   *\n   * @param template The Remote Config template to be published.\n   * @param options Optional options object when publishing a Remote Config template:\n   *    - {boolean} `force` Setting this to `true` forces the Remote Config template to\n   *      be updated and circumvent the ETag. This approach is not recommended\n   *      because it risks causing the loss of updates to your Remote Config\n   *      template if multiple clients are updating the Remote Config template.\n   *      See {@link https://firebase.google.com/docs/remote-config/use-config-rest#etag_usage_and_forced_updates\n   *      ETag usage and forced updates}.\n   *\n   * @return A Promise that fulfills with the published `RemoteConfigTemplate`.\n   */\n\n\n  RemoteConfig.prototype.publishTemplate = function (template, options) {\n    return this.client.publishTemplate(template, options).then(function (templateResponse) {\n      return new RemoteConfigTemplateImpl(templateResponse);\n    });\n  };\n  /**\n   * Rolls back a project's published Remote Config template to the specified version.\n   * A rollback is equivalent to getting a previously published Remote Config\n   * template and re-publishing it using a force update.\n   *\n   * @param versionNumber The version number of the Remote Config template to roll back to.\n   *    The specified version number must be lower than the current version number, and not have\n   *    been deleted due to staleness. Only the last 300 versions are stored.\n   *    All versions that correspond to non-active Remote Config templates (that is, all except the\n   *    template that is being fetched by clients) are also deleted if they are more than 90 days old.\n   * @return A promise that fulfills with the published `RemoteConfigTemplate`.\n   */\n\n\n  RemoteConfig.prototype.rollback = function (versionNumber) {\n    return this.client.rollback(versionNumber).then(function (templateResponse) {\n      return new RemoteConfigTemplateImpl(templateResponse);\n    });\n  };\n  /**\n   * Gets a list of Remote Config template versions that have been published, sorted in reverse\n   * chronological order. Only the last 300 versions are stored.\n   * All versions that correspond to non-active Remote Config templates (i.e., all except the\n   * template that is being fetched by clients) are also deleted if they are older than 90 days.\n   *\n   * @param options Optional options object for getting a list of versions.\n   * @return A promise that fulfills with a `ListVersionsResult`.\n   */\n\n\n  RemoteConfig.prototype.listVersions = function (options) {\n    return this.client.listVersions(options).then(function (listVersionsResponse) {\n      var _a, _b;\n\n      return {\n        versions: (_b = (_a = listVersionsResponse.versions) === null || _a === void 0 ? void 0 : _a.map(function (version) {\n          return new VersionImpl(version);\n        })) !== null && _b !== void 0 ? _b : [],\n        nextPageToken: listVersionsResponse.nextPageToken\n      };\n    });\n  };\n  /**\n   * Creates and returns a new Remote Config template from a JSON string.\n   *\n   * @param json The JSON string to populate a Remote Config template.\n   *\n   * @return A new template instance.\n   */\n\n\n  RemoteConfig.prototype.createTemplateFromJSON = function (json) {\n    if (!validator.isNonEmptyString(json)) {\n      throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'JSON string must be a valid non-empty string');\n    }\n\n    var template;\n\n    try {\n      template = JSON.parse(json);\n    } catch (e) {\n      throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Failed to parse the JSON string: \" + json + \". \" + e);\n    }\n\n    return new RemoteConfigTemplateImpl(template);\n  };\n\n  return RemoteConfig;\n}();\n\nexports.RemoteConfig = RemoteConfig;\n/**\n * Remote Config template internal implementation.\n */\n\nvar RemoteConfigTemplateImpl =\n/** @class */\nfunction () {\n  function RemoteConfigTemplateImpl(config) {\n    if (!validator.isNonNullObject(config) || !validator.isNonEmptyString(config.etag)) {\n      throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Invalid Remote Config template: \" + JSON.stringify(config));\n    }\n\n    this.etagInternal = config.etag;\n\n    if (typeof config.parameters !== 'undefined') {\n      if (!validator.isNonNullObject(config.parameters)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config parameters must be a non-null object');\n      }\n\n      this.parameters = config.parameters;\n    } else {\n      this.parameters = {};\n    }\n\n    if (typeof config.parameterGroups !== 'undefined') {\n      if (!validator.isNonNullObject(config.parameterGroups)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config parameter groups must be a non-null object');\n      }\n\n      this.parameterGroups = config.parameterGroups;\n    } else {\n      this.parameterGroups = {};\n    }\n\n    if (typeof config.conditions !== 'undefined') {\n      if (!validator.isArray(config.conditions)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config conditions must be an array');\n      }\n\n      this.conditions = config.conditions;\n    } else {\n      this.conditions = [];\n    }\n\n    if (typeof config.version !== 'undefined') {\n      this.version = new VersionImpl(config.version);\n    }\n  }\n\n  Object.defineProperty(RemoteConfigTemplateImpl.prototype, \"etag\", {\n    /**\n     * Gets the ETag of the template.\n     *\n     * @return {string} The ETag of the Remote Config template.\n     */\n    get: function () {\n      return this.etagInternal;\n    },\n    enumerable: false,\n    configurable: true\n  });\n  /**\n   * @return {RemoteConfigTemplate} A JSON-serializable representation of this object.\n   */\n\n  RemoteConfigTemplateImpl.prototype.toJSON = function () {\n    return {\n      conditions: this.conditions,\n      parameters: this.parameters,\n      parameterGroups: this.parameterGroups,\n      etag: this.etag,\n      version: this.version\n    };\n  };\n\n  return RemoteConfigTemplateImpl;\n}();\n/**\n* Remote Config Version internal implementation.\n*/\n\n\nvar VersionImpl =\n/** @class */\nfunction () {\n  function VersionImpl(version) {\n    if (!validator.isNonNullObject(version)) {\n      throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Invalid Remote Config version instance: \" + JSON.stringify(version));\n    }\n\n    if (typeof version.versionNumber !== 'undefined') {\n      if (!validator.isNonEmptyString(version.versionNumber) && !validator.isNumber(version.versionNumber)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version number must be a non-empty string in int64 format or a number');\n      }\n\n      if (!Number.isInteger(Number(version.versionNumber))) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version number must be an integer or a string in int64 format');\n      }\n\n      this.versionNumber = version.versionNumber;\n    }\n\n    if (typeof version.updateOrigin !== 'undefined') {\n      if (!validator.isNonEmptyString(version.updateOrigin)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update origin must be a non-empty string');\n      }\n\n      this.updateOrigin = version.updateOrigin;\n    }\n\n    if (typeof version.updateType !== 'undefined') {\n      if (!validator.isNonEmptyString(version.updateType)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update type must be a non-empty string');\n      }\n\n      this.updateType = version.updateType;\n    }\n\n    if (typeof version.updateUser !== 'undefined') {\n      if (!validator.isNonNullObject(version.updateUser)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update user must be a non-null object');\n      }\n\n      this.updateUser = version.updateUser;\n    }\n\n    if (typeof version.description !== 'undefined') {\n      if (!validator.isNonEmptyString(version.description)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version description must be a non-empty string');\n      }\n\n      this.description = version.description;\n    }\n\n    if (typeof version.rollbackSource !== 'undefined') {\n      if (!validator.isNonEmptyString(version.rollbackSource)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version rollback source must be a non-empty string');\n      }\n\n      this.rollbackSource = version.rollbackSource;\n    }\n\n    if (typeof version.isLegacy !== 'undefined') {\n      if (!validator.isBoolean(version.isLegacy)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version.isLegacy must be a boolean');\n      }\n\n      this.isLegacy = version.isLegacy;\n    } // The backend API provides timestamps in ISO date strings. The Admin SDK exposes timestamps\n    // in UTC date strings. If a developer uses a previously obtained template with UTC timestamps\n    // we could still validate it below.\n\n\n    if (typeof version.updateTime !== 'undefined') {\n      if (!this.isValidTimestamp(version.updateTime)) {\n        throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update time must be a valid date string');\n      }\n\n      this.updateTime = new Date(version.updateTime).toUTCString();\n    }\n  }\n  /**\n   * @return {Version} A JSON-serializable representation of this object.\n   */\n\n\n  VersionImpl.prototype.toJSON = function () {\n    return {\n      versionNumber: this.versionNumber,\n      updateOrigin: this.updateOrigin,\n      updateType: this.updateType,\n      updateUser: this.updateUser,\n      description: this.description,\n      rollbackSource: this.rollbackSource,\n      isLegacy: this.isLegacy,\n      updateTime: this.updateTime\n    };\n  };\n\n  VersionImpl.prototype.isValidTimestamp = function (timestamp) {\n    // This validation fails for timestamps earlier than January 1, 1970 and considers strings\n    // such as \"1.2\" as valid timestamps.\n    return validator.isNonEmptyString(timestamp) && new Date(timestamp).getTime() > 0;\n  };\n\n  return VersionImpl;\n}();","map":{"version":3,"sources":["/Users/piyushmaheshwari/Downloads/github/Bridgeorg/node_modules/firebase-admin/lib/remote-config/remote-config.js"],"names":["Object","defineProperty","exports","value","RemoteConfig","validator","require","remote_config_api_client_internal_1","app","client","RemoteConfigApiClient","prototype","getTemplate","then","templateResponse","RemoteConfigTemplateImpl","getTemplateAtVersion","versionNumber","validateTemplate","template","publishTemplate","options","rollback","listVersions","listVersionsResponse","_a","_b","versions","map","version","VersionImpl","nextPageToken","createTemplateFromJSON","json","isNonEmptyString","FirebaseRemoteConfigError","JSON","parse","e","config","isNonNullObject","etag","stringify","etagInternal","parameters","parameterGroups","conditions","isArray","get","enumerable","configurable","toJSON","isNumber","Number","isInteger","updateOrigin","updateType","updateUser","description","rollbackSource","isLegacy","isBoolean","updateTime","isValidTimestamp","Date","toUTCString","timestamp","getTime"],"mappings":"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","sourcesContent":["/*! firebase-admin v9.6.0 */\n\"use strict\";\n/*!\n * Copyright 2020 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.RemoteConfig = void 0;\nvar validator = require(\"../utils/validator\");\nvar remote_config_api_client_internal_1 = require(\"./remote-config-api-client-internal\");\n/**\n * Remote Config service bound to the provided app.\n */\nvar RemoteConfig = /** @class */ (function () {\n    /**\n     * @param app The app for this RemoteConfig service.\n     * @constructor\n     */\n    function RemoteConfig(app) {\n        this.app = app;\n        this.client = new remote_config_api_client_internal_1.RemoteConfigApiClient(app);\n    }\n    /**\n     * Gets the current active version of the {@link remoteConfig.RemoteConfigTemplate\n     * `RemoteConfigTemplate`} of the project.\n     *\n     * @return A promise that fulfills with a `RemoteConfigTemplate`.\n     */\n    RemoteConfig.prototype.getTemplate = function () {\n        return this.client.getTemplate()\n            .then(function (templateResponse) {\n            return new RemoteConfigTemplateImpl(templateResponse);\n        });\n    };\n    /**\n     * Gets the requested version of the {@link remoteConfig.RemoteConfigTemplate\n      * `RemoteConfigTemplate`} of the project.\n     *\n     * @param versionNumber Version number of the Remote Config template to look up.\n     *\n     * @return A promise that fulfills with a `RemoteConfigTemplate`.\n     */\n    RemoteConfig.prototype.getTemplateAtVersion = function (versionNumber) {\n        return this.client.getTemplateAtVersion(versionNumber)\n            .then(function (templateResponse) {\n            return new RemoteConfigTemplateImpl(templateResponse);\n        });\n    };\n    /**\n     * Validates a {@link remoteConfig.RemoteConfigTemplate `RemoteConfigTemplate`}.\n     *\n     * @param template The Remote Config template to be validated.\n     * @returns A promise that fulfills with the validated `RemoteConfigTemplate`.\n     */\n    RemoteConfig.prototype.validateTemplate = function (template) {\n        return this.client.validateTemplate(template)\n            .then(function (templateResponse) {\n            return new RemoteConfigTemplateImpl(templateResponse);\n        });\n    };\n    /**\n     * Publishes a Remote Config template.\n     *\n     * @param template The Remote Config template to be published.\n     * @param options Optional options object when publishing a Remote Config template:\n     *    - {boolean} `force` Setting this to `true` forces the Remote Config template to\n     *      be updated and circumvent the ETag. This approach is not recommended\n     *      because it risks causing the loss of updates to your Remote Config\n     *      template if multiple clients are updating the Remote Config template.\n     *      See {@link https://firebase.google.com/docs/remote-config/use-config-rest#etag_usage_and_forced_updates\n     *      ETag usage and forced updates}.\n     *\n     * @return A Promise that fulfills with the published `RemoteConfigTemplate`.\n     */\n    RemoteConfig.prototype.publishTemplate = function (template, options) {\n        return this.client.publishTemplate(template, options)\n            .then(function (templateResponse) {\n            return new RemoteConfigTemplateImpl(templateResponse);\n        });\n    };\n    /**\n     * Rolls back a project's published Remote Config template to the specified version.\n     * A rollback is equivalent to getting a previously published Remote Config\n     * template and re-publishing it using a force update.\n     *\n     * @param versionNumber The version number of the Remote Config template to roll back to.\n     *    The specified version number must be lower than the current version number, and not have\n     *    been deleted due to staleness. Only the last 300 versions are stored.\n     *    All versions that correspond to non-active Remote Config templates (that is, all except the\n     *    template that is being fetched by clients) are also deleted if they are more than 90 days old.\n     * @return A promise that fulfills with the published `RemoteConfigTemplate`.\n     */\n    RemoteConfig.prototype.rollback = function (versionNumber) {\n        return this.client.rollback(versionNumber)\n            .then(function (templateResponse) {\n            return new RemoteConfigTemplateImpl(templateResponse);\n        });\n    };\n    /**\n     * Gets a list of Remote Config template versions that have been published, sorted in reverse\n     * chronological order. Only the last 300 versions are stored.\n     * All versions that correspond to non-active Remote Config templates (i.e., all except the\n     * template that is being fetched by clients) are also deleted if they are older than 90 days.\n     *\n     * @param options Optional options object for getting a list of versions.\n     * @return A promise that fulfills with a `ListVersionsResult`.\n     */\n    RemoteConfig.prototype.listVersions = function (options) {\n        return this.client.listVersions(options)\n            .then(function (listVersionsResponse) {\n            var _a, _b;\n            return {\n                versions: (_b = (_a = listVersionsResponse.versions) === null || _a === void 0 ? void 0 : _a.map(function (version) { return new VersionImpl(version); })) !== null && _b !== void 0 ? _b : [],\n                nextPageToken: listVersionsResponse.nextPageToken,\n            };\n        });\n    };\n    /**\n     * Creates and returns a new Remote Config template from a JSON string.\n     *\n     * @param json The JSON string to populate a Remote Config template.\n     *\n     * @return A new template instance.\n     */\n    RemoteConfig.prototype.createTemplateFromJSON = function (json) {\n        if (!validator.isNonEmptyString(json)) {\n            throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'JSON string must be a valid non-empty string');\n        }\n        var template;\n        try {\n            template = JSON.parse(json);\n        }\n        catch (e) {\n            throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Failed to parse the JSON string: \" + json + \". \" + e);\n        }\n        return new RemoteConfigTemplateImpl(template);\n    };\n    return RemoteConfig;\n}());\nexports.RemoteConfig = RemoteConfig;\n/**\n * Remote Config template internal implementation.\n */\nvar RemoteConfigTemplateImpl = /** @class */ (function () {\n    function RemoteConfigTemplateImpl(config) {\n        if (!validator.isNonNullObject(config) ||\n            !validator.isNonEmptyString(config.etag)) {\n            throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Invalid Remote Config template: \" + JSON.stringify(config));\n        }\n        this.etagInternal = config.etag;\n        if (typeof config.parameters !== 'undefined') {\n            if (!validator.isNonNullObject(config.parameters)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config parameters must be a non-null object');\n            }\n            this.parameters = config.parameters;\n        }\n        else {\n            this.parameters = {};\n        }\n        if (typeof config.parameterGroups !== 'undefined') {\n            if (!validator.isNonNullObject(config.parameterGroups)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config parameter groups must be a non-null object');\n            }\n            this.parameterGroups = config.parameterGroups;\n        }\n        else {\n            this.parameterGroups = {};\n        }\n        if (typeof config.conditions !== 'undefined') {\n            if (!validator.isArray(config.conditions)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Remote Config conditions must be an array');\n            }\n            this.conditions = config.conditions;\n        }\n        else {\n            this.conditions = [];\n        }\n        if (typeof config.version !== 'undefined') {\n            this.version = new VersionImpl(config.version);\n        }\n    }\n    Object.defineProperty(RemoteConfigTemplateImpl.prototype, \"etag\", {\n        /**\n         * Gets the ETag of the template.\n         *\n         * @return {string} The ETag of the Remote Config template.\n         */\n        get: function () {\n            return this.etagInternal;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    /**\n     * @return {RemoteConfigTemplate} A JSON-serializable representation of this object.\n     */\n    RemoteConfigTemplateImpl.prototype.toJSON = function () {\n        return {\n            conditions: this.conditions,\n            parameters: this.parameters,\n            parameterGroups: this.parameterGroups,\n            etag: this.etag,\n            version: this.version,\n        };\n    };\n    return RemoteConfigTemplateImpl;\n}());\n/**\n* Remote Config Version internal implementation.\n*/\nvar VersionImpl = /** @class */ (function () {\n    function VersionImpl(version) {\n        if (!validator.isNonNullObject(version)) {\n            throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', \"Invalid Remote Config version instance: \" + JSON.stringify(version));\n        }\n        if (typeof version.versionNumber !== 'undefined') {\n            if (!validator.isNonEmptyString(version.versionNumber) &&\n                !validator.isNumber(version.versionNumber)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version number must be a non-empty string in int64 format or a number');\n            }\n            if (!Number.isInteger(Number(version.versionNumber))) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version number must be an integer or a string in int64 format');\n            }\n            this.versionNumber = version.versionNumber;\n        }\n        if (typeof version.updateOrigin !== 'undefined') {\n            if (!validator.isNonEmptyString(version.updateOrigin)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update origin must be a non-empty string');\n            }\n            this.updateOrigin = version.updateOrigin;\n        }\n        if (typeof version.updateType !== 'undefined') {\n            if (!validator.isNonEmptyString(version.updateType)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update type must be a non-empty string');\n            }\n            this.updateType = version.updateType;\n        }\n        if (typeof version.updateUser !== 'undefined') {\n            if (!validator.isNonNullObject(version.updateUser)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update user must be a non-null object');\n            }\n            this.updateUser = version.updateUser;\n        }\n        if (typeof version.description !== 'undefined') {\n            if (!validator.isNonEmptyString(version.description)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version description must be a non-empty string');\n            }\n            this.description = version.description;\n        }\n        if (typeof version.rollbackSource !== 'undefined') {\n            if (!validator.isNonEmptyString(version.rollbackSource)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version rollback source must be a non-empty string');\n            }\n            this.rollbackSource = version.rollbackSource;\n        }\n        if (typeof version.isLegacy !== 'undefined') {\n            if (!validator.isBoolean(version.isLegacy)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version.isLegacy must be a boolean');\n            }\n            this.isLegacy = version.isLegacy;\n        }\n        // The backend API provides timestamps in ISO date strings. The Admin SDK exposes timestamps\n        // in UTC date strings. If a developer uses a previously obtained template with UTC timestamps\n        // we could still validate it below.\n        if (typeof version.updateTime !== 'undefined') {\n            if (!this.isValidTimestamp(version.updateTime)) {\n                throw new remote_config_api_client_internal_1.FirebaseRemoteConfigError('invalid-argument', 'Version update time must be a valid date string');\n            }\n            this.updateTime = new Date(version.updateTime).toUTCString();\n        }\n    }\n    /**\n     * @return {Version} A JSON-serializable representation of this object.\n     */\n    VersionImpl.prototype.toJSON = function () {\n        return {\n            versionNumber: this.versionNumber,\n            updateOrigin: this.updateOrigin,\n            updateType: this.updateType,\n            updateUser: this.updateUser,\n            description: this.description,\n            rollbackSource: this.rollbackSource,\n            isLegacy: this.isLegacy,\n            updateTime: this.updateTime,\n        };\n    };\n    VersionImpl.prototype.isValidTimestamp = function (timestamp) {\n        // This validation fails for timestamps earlier than January 1, 1970 and considers strings\n        // such as \"1.2\" as valid timestamps.\n        return validator.isNonEmptyString(timestamp) && (new Date(timestamp)).getTime() > 0;\n    };\n    return VersionImpl;\n}());\n"]},"metadata":{},"sourceType":"script"}