{"ast":null,"code":"\"use strict\";\n\nfunction noop() {}\n\nfunction once(emitter, name) {\n  const o = once.spread(emitter, name);\n  const r = o.then(args => args[0]);\n  r.cancel = o.cancel;\n  return r;\n}\n\n(function (once) {\n  function spread(emitter, name) {\n    let c = null;\n    const p = new Promise((resolve, reject) => {\n      function cancel() {\n        emitter.removeListener(name, onEvent);\n        emitter.removeListener('error', onError);\n        p.cancel = noop;\n      }\n\n      function onEvent(...args) {\n        cancel();\n        resolve(args);\n      }\n\n      function onError(err) {\n        cancel();\n        reject(err);\n      }\n\n      c = cancel;\n      emitter.on(name, onEvent);\n      emitter.on('error', onError);\n    });\n\n    if (!c) {\n      throw new TypeError('Could not get `cancel()` function');\n    }\n\n    p.cancel = c;\n    return p;\n  }\n\n  once.spread = spread;\n})(once || (once = {}));\n\nmodule.exports = once;","map":{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":";;AAEA,SAAS,IAAT,GAAa,CAAK;;AAElB,SAAS,IAAT,CACC,OADD,EAEC,IAFD,EAEa;AAEZ,QAAM,CAAC,GAAG,IAAI,CAAC,MAAL,CAAiB,OAAjB,EAA0B,IAA1B,CAAV;AACA,QAAM,CAAC,GAAG,CAAC,CAAC,IAAF,CAAQ,IAAD,IAAe,IAAI,CAAC,CAAD,CAA1B,CAAV;AACA,EAAA,CAAC,CAAC,MAAF,GAAW,CAAC,CAAC,MAAb;AACA,SAAO,CAAP;AACA;;AAED,CAAA,UAAU,IAAV,EAAc;AAWb,WAAgB,MAAhB,CACC,OADD,EAEC,IAFD,EAEa;AAEZ,QAAI,CAAC,GAA+B,IAApC;AACA,UAAM,CAAC,GAAG,IAAI,OAAJ,CAAe,CAAC,OAAD,EAAU,MAAV,KAAoB;AAC5C,eAAS,MAAT,GAAe;AACd,QAAA,OAAO,CAAC,cAAR,CAAuB,IAAvB,EAA6B,OAA7B;AACA,QAAA,OAAO,CAAC,cAAR,CAAuB,OAAvB,EAAgC,OAAhC;AACA,QAAA,CAAC,CAAC,MAAF,GAAW,IAAX;AACA;;AACD,eAAS,OAAT,CAAiB,GAAG,IAApB,EAA+B;AAC9B,QAAA,MAAM;AACN,QAAA,OAAO,CAAC,IAAD,CAAP;AACA;;AACD,eAAS,OAAT,CAAiB,GAAjB,EAA2B;AAC1B,QAAA,MAAM;AACN,QAAA,MAAM,CAAC,GAAD,CAAN;AACA;;AACD,MAAA,CAAC,GAAG,MAAJ;AACA,MAAA,OAAO,CAAC,EAAR,CAAW,IAAX,EAAiB,OAAjB;AACA,MAAA,OAAO,CAAC,EAAR,CAAW,OAAX,EAAoB,OAApB;AACA,KAjBS,CAAV;;AAkBA,QAAI,CAAC,CAAL,EAAQ;AACP,YAAM,IAAI,SAAJ,CAAc,mCAAd,CAAN;AACA;;AACD,IAAA,CAAC,CAAC,MAAF,GAAW,CAAX;AACA,WAAO,CAAP;AACA;;AA5Be,EAAA,IAAA,CAAA,MAAA,GAAM,MAAN;AA6BhB,CAxCD,EAAU,IAAI,KAAJ,IAAI,GAAA,EAAA,CAAd;;AA0CA,MAAA,CAAA,OAAA,GAAS,IAAT","sourceRoot":"","sourcesContent":["\"use strict\";\nfunction noop() { }\nfunction once(emitter, name) {\n    const o = once.spread(emitter, name);\n    const r = o.then((args) => args[0]);\n    r.cancel = o.cancel;\n    return r;\n}\n(function (once) {\n    function spread(emitter, name) {\n        let c = null;\n        const p = new Promise((resolve, reject) => {\n            function cancel() {\n                emitter.removeListener(name, onEvent);\n                emitter.removeListener('error', onError);\n                p.cancel = noop;\n            }\n            function onEvent(...args) {\n                cancel();\n                resolve(args);\n            }\n            function onError(err) {\n                cancel();\n                reject(err);\n            }\n            c = cancel;\n            emitter.on(name, onEvent);\n            emitter.on('error', onError);\n        });\n        if (!c) {\n            throw new TypeError('Could not get `cancel()` function');\n        }\n        p.cancel = c;\n        return p;\n    }\n    once.spread = spread;\n})(once || (once = {}));\nmodule.exports = once;\n//# sourceMappingURL=index.js.map"]},"metadata":{},"sourceType":"script"}